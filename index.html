<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>EDM VERSEX | Global EDM Pulse, Live Charts & AI DJ Companion</title>

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover">
  <meta name="description" content="EDM VERSEX is an immersive EDM hub with live SoundCloud-powered charts, fresh global releases, trend insights and an AI chat companion for listeners and DJs.">
  <meta name="keywords" content="EDM, electronic dance music, house, trance, techno, SoundCloud charts, latest releases, DJ tools, AI assistant">
  <meta name="author" content="EDM VERSEX">

  <meta property="og:title" content="EDM VERSEX | Global EDM Pulse, Live Charts & AI DJ Companion">
  <meta property="og:description" content="Dive into a live EDM dashboard with SoundCloud-based Top 50, latest releases, trends and an AI assistant tuned for club music.">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://edmversex.com/">
  <meta property="og:image" content="https://edmversex.com/assets/edmversex2-cover.jpg">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="EDM VERSEX | Global EDM Pulse, Live Charts & AI DJ Companion">
  <meta name="twitter:description" content="Live SoundCloud-powered EDM charts, fresh releases and an AI DJ companion in one immersive interface.">

  <link rel="icon" type="image/png" sizes="32x32" href="assets/icon-32.png">
  <link rel="apple-touch-icon" sizes="180x180" href="assets/icon-180.png">

  <script async src="https://pagead2.googlesyndication.com/pagead/js?client=ca-pub-4201977277980522" crossorigin="anonymous"></script>

  <script async src="https://www.googletagmanager.com/gtag/js?id=G-1KFLYZ78XS"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag("js", new Date());
    gtag("config", "G-1KFLYZ78XS");
  </script>

  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            "edm-bg": "#020617",
            "edm-surface": "rgba(15,23,42,0.98)",
            "edm-glass": "rgba(15,23,42,0.82)",
            "edm-glass-soft": "rgba(15,23,42,0.70)",
            "edm-accent": "#22c55e",
            "edm-accent-soft": "#4ade80",
            "edm-highlight": "#38bdf8",
            "edm-pink": "#f472b6"
          },
          boxShadow: {
            "edm-soft": "0 28px 80px rgba(15,23,42,0.95)",
            "edm-chip": "0 10px 26px rgba(15,23,42,0.9)"
          }
        }
      }
    };
  </script>

  <style>
    html, body {
      max-width: 100%;
      overflow-x: hidden;
      scroll-behavior: smooth;
      background: radial-gradient(circle at top, #0f172a 0, #020617 50%, #000 100%);
    }
    :focus-visible {
      outline: 2px solid #22c55e;
      outline-offset: 3px;
    }
    #wave-canvas {
      position: fixed;
      inset: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      opacity: 0.6;
      mix-blend-mode: screen;
      z-index: 0;
    }
    .glass-panel {
      background: radial-gradient(circle at top, rgba(15,23,42,0.96) 0, rgba(15,23,42,0.86) 40%, rgba(15,23,42,0.9) 100%);
      backdrop-filter: blur(24px);
    }
  </style>
</head>
<body class="min-h-screen text-slate-50 antialiased relative">

<a href="#main"
   class="sr-only focus:not-sr-only focus:fixed focus:z-50 focus:top-3 focus:left-3 focus:px-4 focus:py-2 focus:rounded-full focus:bg-slate-900 focus:text-emerald-400">
  Skip to main content
</a>

<canvas id="wave-canvas"></canvas>

<header class="sticky top-0 z-30 border-b border-slate-800/80 backdrop-blur-2xl bg-slate-950/90">
  <nav class="mx-auto max-w-6xl px-4 py-3 flex items-center gap-3">
    <a href="#hero" class="flex items-center gap-2" aria-label="EDM VERSEX home">
      <span class="inline-flex h-10 w-10 rounded-2xl bg-gradient-to-tr from-emerald-500 via-sky-500 to-fuchsia-500 items-center justify-center shadow-edm-chip">
        <span class="h-3 w-6 rounded-full bg-slate-950"></span>
      </span>
      <span class="flex flex-col leading-tight">
        <span class="text-xs font-semibold tracking-[0.24em] uppercase text-emerald-400">EDM VERSEX</span>
        <span class="text-[11px] text-slate-300/90">Global EDM pulse in motion</span>
      </span>
    </a>
    <section class="ml-auto flex items-center gap-2 text-[11px]">
      <nav class="hidden md:flex items-center gap-2">
        <a href="#hero" class="px-3 py-1.5 rounded-full bg-slate-900/80 border border-slate-700/80">Home</a>
        <a href="#pulse" class="px-3 py-1.5 rounded-full bg-slate-900/80 border border-slate-700/80">Pulse</a>
        <a href="#top50" class="px-3 py-1.5 rounded-full bg-slate-900/80 border border-slate-700/80">Top 50</a>
        <a href="#latest" class="px-3 py-1.5 rounded-full bg-slate-900/80 border border-slate-700/80">Latest</a>
        <a href="#guides" class="px-3 py-1.5 rounded-full bg-slate-900/80 border border-slate-700/80">Guides</a>
      </nav>
      <button id="header-chat-open" type="button" class="inline-flex items-center gap-1 px-3 py-1.5 rounded-full bg-emerald-500 text-slate-950 font-semibold">
        <span>âœ¦</span><span class="hidden sm:inline">Ask EDM AI</span><span class="sm:hidden">AI</span>
      </button>
    </section>
  </nav>
  <section class="mx-auto max-w-6xl px-4 pb-3">
    <section class="rounded-2xl bg-slate-950/95 border border-slate-800/90 px-2 py-1 flex items-center justify-center">
      <ins class="adsbygoogle block w-full"
           style="display:block; min-height:60px"
           data-ad-client="ca-pub-4201977277980522"
           data-ad-slot="1234567890"
           data-ad-format="auto"
           data-full-width-responsive="true"></ins>
    </section>
  </section>
</header>

<main id="main" class="relative z-10 mx-auto max-w-6xl px-4 pt-4 pb-16 space-y-8">

  <section id="hero" class="grid grid-cols-1 lg:grid-cols-2 gap-5 items-stretch">
    <section class="glass-panel rounded-3xl border border-slate-800 shadow-edm-soft p-5 relative overflow-hidden">
      <section class="absolute -top-20 -right-24 w-72 h-72 rounded-full bg-emerald-500/25 blur-3xl"></section>
      <section class="absolute -bottom-16 -left-16 w-64 h-64 rounded-full bg-sky-500/25 blur-3xl"></section>
      <section class="relative space-y-4">
        <p class="text-[11px] font-semibold tracking-[0.26em] uppercase text-emerald-400">
          Live electronic dance music dashboard
        </p>
        <h1 class="text-2xl sm:text-3xl lg:text-4xl font-semibold leading-tight text-slate-50">
          Follow the global club signal through live charts, fresh releases and an AI DJ companion.
        </h1>
        <p class="text-sm sm:text-[15px] text-slate-200/90">
          EDM VERSEX 2.0 listens to the public SoundCloud universe, shapes it into a Top 50, tracks the newest releases and overlays it with curated insights and an AI assistant tuned for producers, listeners and DJs.
        </p>
        <section class="grid grid-cols-3 gap-3 text-[11px] sm:text-xs mt-4">
          <section class="rounded-2xl bg-slate-950/80 border border-slate-800/90 px-3 py-2">
            <p class="tracking-[0.22em] uppercase text-slate-400">Tracks in view</p>
            <p id="stat-track-count" class="mt-1 text-slate-50 text-lg font-semibold">â€“</p>
            <p class="mt-0.5 text-slate-400">Across chart and feed.</p>
          </section>
          <section class="rounded-2xl bg-slate-950/80 border border-slate-800/90 px-3 py-2">
            <p class="tracking-[0.22em] uppercase text-slate-400">Last update</p>
            <p id="stat-last-updated" class="mt-1 text-slate-50 text-lg font-semibold">â€“</p>
            <p class="mt-0.5 text-slate-400">Local browser time.</p>
          </section>
          <section class="rounded-2xl bg-slate-950/80 border border-slate-800/90 px-3 py-2">
            <p class="tracking-[0.22em] uppercase text-slate-400">Dominant mood</p>
            <p id="stat-dominant-genre" class="mt-1 text-slate-50 text-lg font-semibold">â€“</p>
            <p class="mt-0.5 text-slate-400">Based on current Top 50.</p>
          </section>
        </section>
        <section class="mt-4 flex flex-wrap items-center gap-2">
          <a href="#top50" class="inline-flex items-center gap-2 px-4 py-2 rounded-full bg-emerald-500 text-slate-950 text-xs font-semibold tracking-[0.16em] uppercase">
            <span>Jump to Top 50</span>
          </a>
          <a href="#latest" class="inline-flex items-center gap-2 px-4 py-2 rounded-full bg-slate-900/90 border border-slate-700/80 text-xs font-semibold tracking-[0.16em] uppercase">
            <span>Explore latest 20</span>
          </a>
        </section>
      </section>
    </section>

    <section class="space-y-4">
      <section class="rounded-3xl bg-edm-glass border border-slate-800 shadow-edm-soft p-4 flex flex-col gap-3">
        <header class="flex items-center justify-between gap-2">
          <section>
            <p class="text-[11px] uppercase tracking-[0.26em] text-emerald-400">Live SoundCloud player</p>
            <p class="text-[11px] text-slate-300/90">Most recent public EDM-leaning upload from the global feed.</p>
          </section>
          <span class="inline-flex items-center gap-1 text-[11px] text-emerald-400">
            <span class="h-2 w-2 rounded-full bg-emerald-400 animate-pulse"></span>
            Live
          </span>
        </header>
        <section id="sc-player" class="rounded-2xl bg-slate-950/90 border border-slate-800 min-h-[220px] flex items-center justify-center text-[11px] text-slate-400">
          Loading SoundCloud playerâ€¦
        </section>
      </section>

      <section id="pulse" class="rounded-3xl bg-edm-glass-soft border border-slate-800 p-4 space-y-3">
        <header class="flex items-center justify-between gap-2">
          <section>
            <p class="text-[11px] uppercase tracking-[0.26em] text-sky-400">Global pulse</p>
            <p class="text-[11px] text-slate-300/90">Editorial mood and evolving search trends.</p>
          </section>
        </header>
        <section class="grid grid-cols-1 gap-3 sm:grid-cols-2">
          <section class="rounded-2xl bg-slate-950/90 border border-slate-800 p-3 flex flex-col gap-2">
            <p class="text-[11px] uppercase tracking-[0.22em] text-emerald-400">Editorial pulse</p>
            <p id="editorial-text" class="text-xs text-slate-200/90 leading-relaxed">
              Loading editorial view of the current EDM landscapeâ€¦
            </p>
          </section>
          <section class="rounded-2xl bg-slate-950/90 border border-slate-800 p-3 flex flex-col gap-2">
            <p class="text-[11px] uppercase tracking-[0.22em] text-sky-400">Trending themes</p>
            <section id="trends-list" class="space-y-2 text-[11px] text-slate-200/90">
              <p>Loading search and mood trendsâ€¦</p>
            </section>
          </section>
        </section>
      </section>
    </section>
  </section>

  <section class="grid grid-cols-1 xl:grid-cols-3 gap-5 items-start">
    <section id="top50" class="xl:col-span-2 rounded-3xl bg-edm-surface border border-slate-800 shadow-edm-soft p-4 sm:p-5 space-y-3">
      <header class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3">
        <section>
          <h2 class="text-sm sm:text-base font-semibold tracking-[0.26em] uppercase text-emerald-400">
            Top 50 public SoundCloud EDM, house and trance
          </h2>
          <p class="mt-1 text-xs sm:text-[13px] text-slate-300/90">
            Derived from public SoundCloud tracks filtered by genre and tags. Sorted by plays and freshness to reflect what is resonating on global dancefloors right now.
          </p>
        </section>
        <section class="flex flex-wrap items-center gap-2 text-[11px]">
          <section class="flex items-center gap-1">
            <button data-genre-filter="all" class="genre-filter-btn px-3 py-1.5 rounded-full bg-emerald-500 text-slate-950 font-semibold">
              All
            </button>
            <button data-genre-filter="house" class="genre-filter-btn px-3 py-1.5 rounded-full bg-slate-950/80 border border-slate-700/80">
              House
            </button>
            <button data-genre-filter="trance" class="genre-filter-btn px-3 py-1.5 rounded-full bg-slate-950/80 border border-slate-700/80">
              Trance
            </button>
            <button data-genre-filter="techno" class="genre-filter-btn px-3 py-1.5 rounded-full bg-slate-950/80 border border-slate-700/80">
              Techno
            </button>
          </section>
          <button id="btn-refresh-top" type="button" class="px-3 py-1.5 rounded-full bg-slate-900/90 border border-slate-700/80 text-slate-100">
            Refresh
          </button>
        </section>
      </header>

      <section class="grid grid-cols-2 gap-2 text-[11px] text-slate-300 mt-2">
        <section class="rounded-2xl bg-slate-950/80 border border-slate-800 p-2">
          <p class="uppercase tracking-[0.2em] text-slate-500">Most played</p>
          <p id="stat-top-track" class="mt-1 text-slate-50 text-sm font-semibold truncate">â€“</p>
        </section>
        <section class="rounded-2xl bg-slate-950/80 border border-slate-800 p-2">
          <p class="uppercase tracking-[0.2em] text-slate-500">Top artist</p>
          <p id="stat-top-artist" class="mt-1 text-slate-50 text-sm font-semibold truncate">â€“</p>
        </section>
      </section>

      <section id="top50-list" class="mt-3 rounded-2xl bg-slate-950/95 border border-slate-800/90 max-h-[460px] overflow-y-auto" aria-live="polite" aria-busy="false">
        <section id="top50-skeleton" class="p-3 space-y-2 text-[11px] text-slate-400">
          <p>Loading chart from backendâ€¦</p>
          <section class="space-y-2 animate-pulse">
            <section class="h-10 rounded-xl bg-slate-800/60"></section>
            <section class="h-10 rounded-xl bg-slate-800/60"></section>
            <section class="h-10 rounded-xl bg-slate-800/60"></section>
          </section>
        </section>
      </section>

      <section class="mt-3 rounded-2xl bg-slate-950/95 border border-slate-800/90 px-3 py-2 text-[10px] text-slate-400">
        <ins class="adsbygoogle block w-full"
             style="display:block; min-height:60px"
             data-ad-client="ca-pub-4201977277980522"
             data-ad-slot="2345678901"
             data-ad-format="auto"
             data-full-width-responsive="true"></ins>
      </section>
    </section>

    <section id="latest" class="rounded-3xl bg-edm-glass border border-slate-800 shadow-edm-soft p-4 sm:p-5 space-y-3">
      <header class="flex flex-col gap-2">
        <h2 class="text-sm sm:text-base font-semibold tracking-[0.26em] uppercase text-emerald-400">
          Latest 20 global EDM-tagged SoundCloud releases
        </h2>
        <p class="text-xs sm:text-[13px] text-slate-300/90">
          The newest public tracks from the same EDM-focused SoundCloud universe. Sorted by upload time so you can catch music early.
        </p>
        <section class="flex items-center gap-2 text-[11px]">
          <button id="btn-refresh-latest" type="button" class="px-3 py-1.5 rounded-full bg-slate-900/90 border border-slate-700/80 text-slate-100">
            Refresh latest
          </button>
        </section>
      </header>

      <section id="latest-list" class="mt-2 rounded-2xl bg-slate-950/95 border border-slate-800/90 max-h-[420px] overflow-y-auto text-[11px]" aria-live="polite" aria-busy="false">
        <section id="latest-skeleton" class="p-3 space-y-2 text-slate-400">
          <p>Pulling fresh releases from backendâ€¦</p>
          <section class="space-y-2 animate-pulse">
            <section class="h-12 rounded-xl bg-slate-800/60"></section>
            <section class="h-12 rounded-xl bg-slate-800/60"></section>
          </section>
        </section>
      </section>

      <section class="mt-3 rounded-2xl bg-slate-950/95 border border-slate-800/90 px-3 py-2 text-[10px] text-slate-400">
        <ins class="adsbygoogle block w-full"
             style="display:block; min-height:60px"
             data-ad-client="ca-pub-4201977277980522"
             data-ad-slot="3456789012"
             data-ad-format="auto"
             data-full-width-responsive="true"></ins>
      </section>
    </section>
  </section>

  <section id="guides" class="grid grid-cols-1 lg:grid-cols-3 gap-5 items-start">
    <section class="lg:col-span-2 rounded-3xl bg-edm-surface border border-slate-800 shadow-edm-soft p-4 sm:p-5 space-y-3">
      <h2 class="text-sm sm:text-base font-semibold tracking-[0.26em] uppercase text-emerald-400">
        Listening journeys and use cases
      </h2>
      <section class="space-y-3 text-sm sm:text-[15px] text-slate-200/90 leading-relaxed">
        <p>
          The Top 50 chart is built for long listening sessions. It mixes highly played public tracks with a bias toward house, trance and techno so you can leave it running while you work, travel or prepare for a set.
        </p>
        <p>
          The Latest 20 list is your early radar. Use it when you want to move one step ahead of playlists, spot rising names, or dig for ideas before they hit larger charts. The combination of both lists makes EDM VERSEX 2.0 a practical daily starting point for new music.
        </p>
        <p>
          Producers can treat the site as a mood scanner: pay attention to tempo, sound design and structure of tracks that appear frequently in the Top 50. Listeners can simply follow their curiosity, jump into artist profiles and build personal playlists on SoundCloud based on the tracks surfaced here.
        </p>
      </section>
    </section>

    <section class="rounded-3xl bg-edm-glass-soft border border-slate-800 shadow-edm-soft p-4 sm:p-5 space-y-3">
      <h2 class="text-sm sm:text-base font-semibold tracking-[0.26em] uppercase text-sky-400">
        For advertisers and partners
      </h2>
      <section class="space-y-2 text-sm sm:text-[15px] text-slate-200/90 leading-relaxed">
        <p>
          EDM VERSEX 2.0 focuses on a narrow, high-intent audience: fans and creators who actively search for new electronic music. Display placements sit next to dense content blocks, never on empty or purely navigational views.
        </p>
        <p>
          This is designed for labels, festivals, hardware brands and music tools that want to speak to a global club-oriented audience in a respectful environment where user experience is a priority.
        </p>
      </section>
      <section class="mt-2 rounded-2xl bg-slate-950/95 border border-slate-800/90 px-3 py-2 text-[11px] text-slate-400">
        <ins class="adsbygoogle block w-full"
             style="display:block; min-height:80px"
             data-ad-client="ca-pub-4201977277980522"
             data-ad-slot="4567890123"
             data-ad-format="auto"
             data-full-width-responsive="true"></ins>
      </section>
    </section>
  </section>

  <section id="about" class="rounded-3xl bg-edm-surface border border-slate-800 shadow-edm-soft p-4 sm:p-5 space-y-3">
    <h2 class="text-sm sm:text-base font-semibold tracking-[0.26em] uppercase text-emerald-400">
      About EDM VERSEX 2.0
    </h2>
    <section class="space-y-2 text-sm sm:text-[15px] text-slate-200/90 leading-relaxed">
      <p>
        EDM VERSEX started as a single SoundCloud-focused feed and has grown into a live global dashboard. The 2.0 version is designed as a daily home for electronic music fans who enjoy discovery, repeated listening and a bit of visual immersion.
      </p>
      <p>
        All external data sources used for charts, releases and trend hints are handled through a secure backend layer. The AI companion is trained to talk specifically about electronic music, club culture and how to use this site as a listening tool.
      </p>
      <p>
        As the ecosystem evolves, EDM VERSEX 2.0 can incorporate new data sources and editorial layers, keeping the core idea simple: open one page, press play, understand what is happening in club music right now.
      </p>
    </section>
  </section>
</main>

<footer class="border-t border-slate-800/80 bg-slate-950/95">
  <section class="mx-auto max-w-6xl px-4 py-3 flex flex-col sm:flex-row items-center justify-between gap-2 text-[11px] text-slate-400">
    <section class="flex items-center gap-2">
      <span>Â© <span id="year"></span> EDM VERSEX</span>
      <span class="hidden sm:inline">Â·</span>
      <a href="privacy.html" class="underline hidden sm:inline">Privacy & cookies</a>
    </section>
    <section class="flex items-center gap-2">
      <a href="#hero" class="underline">Back to top</a>
    </section>
  </section>
</footer>

<section id="ai-chat-root" class="fixed bottom-4 right-4 z-40 flex flex-col items-end gap-2">
  <button id="ai-chat-toggle" type="button" class="inline-flex items-center gap-2 px-4 py-2 rounded-full bg-gradient-to-r from-emerald-500 via-sky-500 to-fuchsia-500 text-slate-950 text-xs font-semibold shadow-edm-chip">
    <span>âœ¦ EDM VERSEX AI</span>
  </button>
  <section id="ai-chat-panel" class="hidden w-[320px] sm:w-[360px] rounded-3xl bg-slate-950/95 border border-slate-800 shadow-edm-soft overflow-hidden">
    <header class="px-3 py-2 border-b border-slate-800 flex items-center justify-between gap-2">
      <section class="flex items-center gap-2">
        <span class="inline-flex h-7 w-7 rounded-full bg-gradient-to-tr from-emerald-500 via-sky-500 to-fuchsia-500 items-center justify-center text-[13px] text-slate-950">AI</span>
        <section class="flex flex-col leading-tight">
          <span class="text-[11px] font-semibold text-slate-100">EDM VERSEX AI Companion</span>
          <span class="text-[10px] text-slate-400">Ask about tracks, trends and listening ideas.</span>
        </section>
      </section>
      <button id="ai-chat-close" type="button" class="h-7 w-7 rounded-full bg-slate-900/90 text-slate-300 text-xs flex items-center justify-center">âœ•</button>
    </header>
    <section id="ai-chat-messages" class="px-3 py-3 max-h-72 overflow-y-auto space-y-2 text-[11px]">
      <section class="flex justify-start">
        <section class="max-w-[85%] rounded-2xl bg-slate-900/90 border border-slate-700/80 px-3 py-2">
          <p class="text-[10px] text-emerald-400 mb-0.5">EDM VERSEX AI</p>
          <p class="text-slate-100">
            Hi, I am tuned for electronic music. You can ask me how to explore the Top 50, where to start in the Latest 20, or what kind of sounds are moving club floors right now.
          </p>
        </section>
      </section>
    </section>
    <section class="px-3 py-2 border-t border-slate-800 bg-slate-950/98">
      <form id="ai-chat-form" class="flex items-center gap-2">
        <input id="ai-chat-input" type="text" autocomplete="off" placeholder="Ask about EDM, tracks or how to use this pageâ€¦" class="flex-1 rounded-full bg-slate-900/95 border border-slate-700/80 px-3 py-1.5 text-[11px] text-slate-100 placeholder:text-slate-500 outline-none">
        <button type="submit" class="h-8 px-3 rounded-full bg-emerald-500 text-slate-950 text-[11px] font-semibold">Send</button>
      </form>
    </section>
  </section>
</section>

<noscript>
  <section class="mx-auto max-w-6xl mt-4 px-4">
    <section class="rounded-2xl bg-red-900/85 text-red-100 p-3 text-xs">
      JavaScript is disabled. Live charts, latest releases and the AI assistant require JavaScript to function.
    </section>
  </section>
</noscript>

<script>
  (function () {
    "use strict";

    var API_BASE = "https://royal-union-d5f0.kalleuusitalo1.workers.dev";
    var TOP_50_ENDPOINT = API_BASE + "/api/top50";
    var LATEST_ENDPOINT = API_BASE + "/api/latest";
    var PLAYER_ENDPOINT = API_BASE + "/api/player-url";
    var EDITORIAL_ENDPOINT = API_BASE + "/api/editorial";
    var TRENDS_ENDPOINT = API_BASE + "/api/trends-summary";
    var CHAT_ENDPOINT = API_BASE + "/api/chat";

    var top50Container = document.getElementById("top50-list");
    var top50Skeleton = document.getElementById("top50-skeleton");
    var latestContainer = document.getElementById("latest-list");
    var latestSkeleton = document.getElementById("latest-skeleton");
    var editorialText = document.getElementById("editorial-text");
    var trendsList = document.getElementById("trends-list");
    var scPlayerBox = document.getElementById("sc-player");

    var statTrackCount = document.getElementById("stat-track-count");
    var statLastUpdated = document.getElementById("stat-last-updated");
    var statDominantGenre = document.getElementById("stat-dominant-genre");
    var statTopTrack = document.getElementById("stat-top-track");
    var statTopArtist = document.getElementById("stat-top-artist");

    var btnRefreshTop = document.getElementById("btn-refresh-top");
    var btnRefreshLatest = document.getElementById("btn-refresh-latest");
    var genreButtons = document.querySelectorAll(".genre-filter-btn");

    var chatRoot = document.getElementById("ai-chat-root");
    var chatToggle = document.getElementById("ai-chat-toggle");
    var chatPanel = document.getElementById("ai-chat-panel");
    var chatClose = document.getElementById("ai-chat-close");
    var chatForm = document.getElementById("ai-chat-form");
    var chatInput = document.getElementById("ai-chat-input");
    var chatMessages = document.getElementById("ai-chat-messages");
    var headerChatOpen = document.getElementById("header-chat-open");

    var yearSpan = document.getElementById("year");
    if (yearSpan) {
      yearSpan.textContent = new Date().getFullYear();
    }

    var top50Data = [];
    var latestData = [];
    var currentGenreFilter = "all";

    function setText(el, text) {
      if (el) el.textContent = String(text == null ? "" : text);
    }

    function formatNumber(n) {
      var v = typeof n === "number" ? n : Number(n || 0);
      if (!isFinite(v)) return "-";
      if (v >= 1000000) return (v / 1000000).toFixed(1) + "M";
      if (v >= 1000) return (v / 1000).toFixed(1) + "k";
      return v.toString();
    }

    function normalizeGenre(genre) {
      var g = String(genre || "").toLowerCase();
      if (g.indexOf("house") !== -1) return "house";
      if (g.indexOf("trance") !== -1) return "trance";
      if (g.indexOf("techno") !== -1) return "techno";
      return "other";
    }

    function fetchJSON(url, options) {
      return fetch(url, options || { cache: "no-store" }).then(function (res) {
        if (!res.ok) throw new Error("HTTP " + res.status);
        return res.json();
      });
    }

    function renderTop50() {
      if (!top50Container) return;
      top50Container.setAttribute("aria-busy", "true");
      if (top50Skeleton) top50Skeleton.style.display = "none";

      var html = top50Data.map(function (t) {
        var normGenre = normalizeGenre(t.genre);
        var highlighted = currentGenreFilter === "all" || currentGenreFilter === normGenre;
        var highlightClass = highlighted ? "border-emerald-500/70 bg-slate-900/95" : "border-slate-800 bg-slate-950/80 opacity-90";

        return (
          '<article class="m-1 rounded-2xl border ' + highlightClass + ' p-2.5 flex items-center gap-3 text-[11px] sm:text-[13px]">' +
            '<section class="flex flex-col items-center justify-center w-7">' +
              '<span class="text-xs font-semibold text-slate-300">#' + String(t.rank || "?") + "</span>" +
            "</section>" +
            '<section class="flex-1 min-w-0">' +
              '<p class="text-[10px] uppercase tracking-[0.2em] text-slate-500">' + (t.genre || "EDM") + "</p>" +
              '<a href="' + (t.url || "#") + '" target="_blank" rel="noopener noreferrer" class="block truncate text-slate-50 font-semibold hover:text-emerald-400">' +
                (t.title || "Untitled track") +
              "</a>" +
              '<p class="text-[11px] text-slate-400 truncate">by ' + (t.artist || "Unknown artist") + "</p>" +
            "</section>" +
            '<section class="flex flex-col items-end text-right text-[10px] text-slate-400 gap-0.5">' +
              '<span>ðŸŽ§ ' + formatNumber(t.plays || 0) + " plays</span>" +
              '<a href="' + (t.url || "#") + '" target="_blank" rel="noopener noreferrer" class="inline-flex items-center justify-center px-2 py-0.5 rounded-full border border-emerald-500/80 text-[10px] text-emerald-400 hover:bg-emerald-500 hover:text-slate-950 transition-colors">' +
                "Open" +
              "</a>" +
            "</section>" +
          "</article>"
        );
      }).join("");

      top50Container.innerHTML = html;
      top50Container.setAttribute("aria-busy", "false");
    }

    function renderLatest() {
      if (!latestContainer) return;
      latestContainer.setAttribute("aria-busy", "true");
      if (latestSkeleton) latestSkeleton.style.display = "none";

      var html = latestData.map(function (t) {
        return (
          '<article class="m-1 rounded-2xl border border-slate-800 bg-slate-950/90 p-3 flex items-center gap-3 text-[11px] sm:text-[13px]">' +
            '<section class="flex-1 min-w-0">' +
              '<p class="text-[10px] uppercase tracking-[0.2em] text-sky-400">' + (t.genre || "EDM") + "</p>" +
              '<a href="' + (t.url || "#") + '" target="_blank" rel="noopener noreferrer" class="block truncate text-slate-50 font-semibold hover:text-emerald-400">' +
                (t.title || "Untitled track") +
              "</a>" +
              '<p class="text-[11px] text-slate-400 truncate">by ' + (t.artist || "Unknown artist") + "</p>" +
              '<p class="text-[10px] text-slate-500 mt-0.5">' + (t.uploaded_at || "") + "</p>" +
            "</section>" +
            '<section class="flex flex-col items-end text-right gap-1 text-[10px] text-slate-400">' +
              '<a href="' + (t.url || "#") + '" target="_blank" rel="noopener noreferrer" class="inline-flex items-center justify-center px-2.5 py-0.5 rounded-full bg-slate-900/80 border border-slate-700/80 hover:bg-slate-800">' +
                "Open" +
              "</a>" +
            "</section>" +
          "</article>"
        );
      }).join("");

      latestContainer.innerHTML = html;
      latestContainer.setAttribute("aria-busy", "false");
    }

    function updateStats() {
      if (!top50Data || !top50Data.length) return;
      setText(statTrackCount, top50Data.length + latestData.length);

      var now = new Date();
      setText(statLastUpdated, now.toLocaleTimeString());

      var topTrack = top50Data[0];
      setText(statTopTrack, topTrack ? topTrack.title : "â€“");
      setText(statTopArtist, topTrack ? topTrack.artist : "â€“");

      var genreMap = {};
      top50Data.forEach(function (t) {
        var norm = normalizeGenre(t.genre);
        genreMap[norm] = (genreMap[norm] || 0) + 1;
      });
      var genres = Object.keys(genreMap);
      var dominant = genres.sort(function (a, b) {
        return (genreMap[b] || 0) - (genreMap[a] || 0);
      })[0];
      setText(statDominantGenre, dominant ? dominant.toUpperCase() : "MIXED");
    }

    function loadTop50() {
      fetchJSON(TOP_50_ENDPOINT)
        .then(function (data) {
          if (!Array.isArray(data) || !data.length) return;
          top50Data = data;
          renderTop50();
          updateStats();
        })
        .catch(function () {});
    }

    function loadLatest() {
      fetchJSON(LATEST_ENDPOINT)
        .then(function (data) {
          if (!Array.isArray(data) || !data.length) return;
          latestData = data;
          renderLatest();
          updateStats();
        })
        .catch(function () {});
    }

    function loadEditorial() {
      fetchJSON(EDITORIAL_ENDPOINT)
        .then(function (data) {
          if (!editorialText) return;
          if (data && data.text) editorialText.textContent = data.text;
        })
        .catch(function () {
          if (editorialText) editorialText.textContent = "EDM never stops. Use todayâ€™s Top 50 to feel what is shaking dancefloors and the Latest 20 to discover music before it spreads to bigger playlists.";
        });
    }

    function loadTrends() {
      fetchJSON(TRENDS_ENDPOINT)
        .then(function (items) {
          if (!trendsList) return;
          if (!Array.isArray(items) || !items.length) {
            trendsList.innerHTML = '<p>No external trend data available right now.</p>';
            return;
          }
          var html = items.map(function (it) {
            return (
              '<section class="rounded-2xl bg-slate-900/90 border border-slate-800 px-3 py-2">' +
                '<p class="text-[10px] uppercase tracking-[0.2em] text-slate-500">' +
                  (it.category || "Trend") +
                  " Â· " +
                  (it.region || "Global") +
                "</p>" +
                '<p class="text-[11px] text-slate-100 font-semibold mt-0.5">' +
                  (it.term || "") +
                "</p>" +
                '<p class="text-[10px] text-slate-400 mt-0.5">' +
                  (it.description || "") +
                "</p>" +
                '<p class="text-[10px] text-emerald-400 mt-0.5">' +
                  "Interest: " +
                  (typeof it.score === "number" ? it.score : "") +
                  (it.change ? " Â· " + it.change : "") +
                "</p>" +
              "</section>"
            );
          }).join("");
          trendsList.innerHTML = html;
        })
        .catch(function () {
          if (!trendsList) return;
          trendsList.innerHTML = '<p>Trend hints are temporarily unavailable.</p>';
        });
    }

    function loadPlayer() {
      if (!scPlayerBox) return;
      fetchJSON(PLAYER_ENDPOINT)
        .then(function (data) {
          if (!data || !data.url) {
            scPlayerBox.textContent = "No playable track could be loaded right now.";
            return;
          }
          var src = "https://w.soundcloud.com/player/?url=" + encodeURIComponent(data.url) + "&color=%2322c55e&auto_play=false&hide_related=false&show_comments=true&show_user=true&show_reposts=false&show_teaser=true&visual=true";
          scPlayerBox.innerHTML =
            '<iframe title="EDM VERSEX latest track" width="100%" height="260" scrolling="no" frameborder="no" allow="autoplay" src="' +
            src +
            '"></iframe>';
        })
        .catch(function () {
          scPlayerBox.textContent = "Error loading SoundCloud player.";
        });
    }

    genreButtons.forEach(function (btn) {
      btn.addEventListener("click", function () {
        var f = btn.getAttribute("data-genre-filter") || "all";
        currentGenreFilter = f;
        genreButtons.forEach(function (b) {
          b.classList.remove("bg-emerald-500", "text-slate-950");
          b.classList.add("bg-slate-950/80", "border-slate-700/80");
        });
        btn.classList.add("bg-emerald-500", "text-slate-950");
        renderTop50();
      });
    });

    if (btnRefreshTop) btnRefreshTop.addEventListener("click", loadTop50);
    if (btnRefreshLatest) btnRefreshLatest.addEventListener("click", loadLatest);

    function appendChatBubble(role, text) {
      if (!chatMessages) return;
      var alignClass = role === "user" ? "justify-end" : "justify-start";
      var bubbleColor = role === "user" ? "bg-emerald-500 text-slate-950" : "bg-slate-900/90 text-slate-100";
      var label = role === "user" ? "You" : "EDM VERSEX AI";
      var html =
        '<section class="flex ' + alignClass + '">' +
          '<section class="max-w-[85%] rounded-2xl ' + bubbleColor + ' border border-slate-800 px-3 py-2">' +
            '<p class="text-[10px] mb-0.5 ' + (role === "user" ? "text-slate-900/80" : "text-emerald-400") + '">' +
              label +
            "</p>" +
            '<p class="text-[11px]">' +
              text +
            "</p>" +
          "</section>" +
        "</section>";
      chatMessages.insertAdjacentHTML("beforeend", html);
      chatMessages.scrollTop = chatMessages.scrollHeight;
    }

    function toggleChat(open) {
      if (!chatPanel) return;
      var shouldOpen = typeof open === "boolean" ? open : chatPanel.classList.contains("hidden");
      if (shouldOpen) {
        chatPanel.classList.remove("hidden");
        if (chatInput) chatInput.focus();
      } else {
        chatPanel.classList.add("hidden");
      }
    }

    if (chatToggle) chatToggle.addEventListener("click", function () { toggleChat(true); });
    if (headerChatOpen) headerChatOpen.addEventListener("click", function () { toggleChat(true); });
    if (chatClose) chatClose.addEventListener("click", function () { toggleChat(false); });

    if (chatForm) {
      chatForm.addEventListener("submit", function (e) {
        e.preventDefault();
        if (!chatInput) return;
        var message = chatInput.value.trim();
        if (!message) return;
        appendChatBubble("user", message);
        chatInput.value = "";
        var loadingId = "ai-loading-" + Date.now();
        chatMessages.insertAdjacentHTML(
          "beforeend",
          '<section id="' + loadingId + '" class="flex justify-start">' +
            '<section class="max-w-[85%] rounded-2xl bg-slate-900/90 border border-slate-800 px-3 py-2 text-[11px] text-slate-300">' +
              "Thinking about club music and releasesâ€¦" +
            "</section>" +
          "</section>"
        );
        chatMessages.scrollTop = chatMessages.scrollHeight;

        fetchJSON(CHAT_ENDPOINT, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ prompt: message })
        })
          .then(function (data) {
            var loader = document.getElementById(loadingId);
            if (loader && loader.parentNode) loader.parentNode.removeChild(loader);
            var text = data && data.answer ? data.answer : "I could not reach the AI backend right now, but you can still explore the Top 50 and Latest 20 lists for fresh music.";
            appendChatBubble("assistant", text);
          })
          .catch(function () {
            var loader = document.getElementById(loadingId);
            if (loader && loader.parentNode) loader.parentNode.removeChild(loader);
            appendChatBubble("assistant", "I could not reach the AI backend right now. Try again in a moment or use the charts as your guide.");
          });
      });
    }

    var canvas = document.getElementById("wave-canvas");
    if (canvas && canvas.getContext) {
      var ctx = canvas.getContext("2d");
      function resize() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
      }
      resize();
      window.addEventListener("resize", resize);
      var t = 0;
      function draw() {
        if (!ctx) return;
        var w = canvas.width;
        var h = canvas.height;
        ctx.clearRect(0, 0, w, h);
        ctx.lineWidth = 1.1;
        var layers = [
          { color: "rgba(34,197,94,0.42)", amp: 32, speed: 0.0017 },
          { color: "rgba(56,189,248,0.40)", amp: 44, speed: 0.0012 },
          { color: "rgba(244,114,182,0.36)", amp: 58, speed: 0.0009 }
        ];
        layers.forEach(function (g, i) {
          ctx.beginPath();
          ctx.strokeStyle = g.color;
          var yBase = h * (0.35 + 0.18 * i);
          for (var x = 0; x <= w; x += 10) {
            var y =
              yBase +
              Math.sin(x * 0.008 + t * g.speed * 250) * g.amp *
              Math.cos(t * g.speed * 140 + i * 0.7);
            if (x === 0) ctx.moveTo(x, y);
            else ctx.lineTo(x, y);
          }
          ctx.stroke();
        });
        t++;
        requestAnimationFrame(draw);
      }
      draw();
    }

    window.addEventListener("load", function () {
      if (window.adsbygoogle) {
        var slots = document.querySelectorAll(".adsbygoogle");
        slots.forEach(function () {
          try {
            (adsbygoogle = window.adsbygoogle || []).push({});
          } catch (e) {}
        });
      }
    });

    loadTop50();
    loadLatest();
    loadEditorial();
    loadTrends();
    loadPlayer();
  })();
</script>

</body>
</html>
